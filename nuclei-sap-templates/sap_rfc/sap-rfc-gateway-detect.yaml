id: sap-rfc-gateway-detect

info:
  name: SAP RFC Gateway detection
  author: randomstr1ng
  severity: info
  description: Detection of SAP RFC Gateway service.
  tags: sap,tech,sap-rfc

tcp:
  - host:
    - "{{Hostname}}"
    port: 3300,3301,3302,3303,3304,3305,3306,3307,3308,3309,3310,3311,3312,3313,3314,3315,3316,3317,3318,3319,3320,3321,3322,3323,3324,3325,3326,3327,3328,3329,3330,3331,3332,3333,3334,3335,3336,3337,3338,3339,3340,3341,3342,3343,3344,3345,3346,3347,3348,3349,3350,3351,3352,3353,3354,3355,3356,3357,3358,3359,3360,3361,3362,3363,3364,3365,3366,3367,3368,3369,3370,3371,3372,3373,3374,3375,3376,3377,3378,3379,3380,3381,3382,3383,3384,3385,3386,3387,3388,3389,3390,3391,3392,3393,3394,3395,3396,3397,3398,3399
    inputs:
      - data: "000000400203ac10007700000000737461727472666300003131303000000000000064656661756c745f7374617274726663202020202020202006cbffff000000000000"
        type: hex
    read-all: true

    matchers:
      - type: binary
        binary:
          - "000000400203ac100077000000007374"