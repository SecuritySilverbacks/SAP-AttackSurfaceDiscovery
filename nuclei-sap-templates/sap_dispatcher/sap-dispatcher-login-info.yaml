id: sap-dispatcher-login-info

info:
  name: SAP Dispatcher Login screen info
  author: randomstr1ng
  severity: info
  description: Extraction of Login screen information from SAP Dispatcher used by SAP GUI for Windows and SAP GUI for Java
  tags: sap,tech

tcp:
  - host:
    - "{{Hostname}}"
    port: 3200,3201,3202,3203,3204,3205,3206,3207,3208,3209,3210,3211,3212,3213,3214,3215,3216,3217,3218,3219,3220,3221,3222,3223,3224,3225,3226,3227,3228,3229,3230,3231,3232,3233,3234,3235,3236,3237,3238,3239,3240,3241,3242,3243,3244,3245,3246,3247,3248,3249,3250,3251,3252,3253,3254,3255,3256,3257,3258,3259,3260,3261,3262,3263,3264,3265,3266,3267,3268,3269,3270,3271,3272,3273,3274,3275,3276,3277,3278,3279,3280,3281,3282,3283,3284,3285,3286,3287,3288,3289,3290,3291,3292,3293,3294,3295,3296,3297,3298
    inputs:
      - data: "00000106ffffffff0a000000000000ffffffffffffffffffffffffffffffffffffff3e00000000ffffffffffff202020202020202020202020202020202020202020202020202020202020202020202020202020200000000000000000000000000000000000000000000000000020202020202020202020202020202020202020200000000000000000ffffffff00000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000100402000c000000800000044c0000138910040b0020ff7ffe2ddab737d674087e1305971597eff23f8d0770ff0f0000000000000000"
        type: hex
    read-all: true

    matchers:
      - type: word
        condition: and
        words:
        - "Logon Language"
        - "RSYST-MANDT"
        - "RSYST-BNAME"
        - "New password"
    extractors:
      - type: regex
        name: banner
        group: 1
        regex:
          - '\@0S\@\s\s\s(.{1,125})'
      - type: regex
        name: instance_details
        group: 1
        regex:
          - '([A-Z0-9]{3}\/.{1,13}\_[A-Z0-9]{3}\_\d{2})'